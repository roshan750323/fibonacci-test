stages {
  stage('Build Docker image') {
    steps {
      script {
        docker.build('roshan750/fibonacci:4.0')
      }
    }
  }
  stage('Push to Docker Hub') {
    steps {
      script {
        docker.withRegistry('https://registry.hub.docker.com', 'docker_roshan') {
          docker.image('roshan750/fibonacci:4.0').push()
        }
      }
    }
  }
  stage('Build and Push Docker Image') {
    steps {
      script {
        def dockerImage = docker.build("sre-training/roshan-fibonacci:2.0", "-f Dockerfile .")
        docker.withRegistry('https://harbor.cubastion.net', 'harbor_sre') {
          dockerImage.push()
        }
      }
    }
  }
  stage('Cleanup') {
    steps {
      cleanWs()
    }
  }
}

